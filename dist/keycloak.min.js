!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("crypto"),require("buffer")):"function"==typeof define&&define.amd?define("keycloak",["crypto","buffer"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Keycloak=t(e.require$$0,e.require$$1)}(this,(function(e,t){"use strict";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var o={exports:{}};!function(e){e.exports=function(){function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function t(e){return"function"==typeof e}function n(e){K=e}function o(e){J=e}function i(){return function(){return process.nextTick(l)}}function s(){return void 0!==V?function(){V(l)}:u()}function a(){var e=0,t=new F(l),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function c(){var e=new MessageChannel;return e.port1.onmessage=l,function(){return e.port2.postMessage(0)}}function u(){var e=setTimeout;return function(){return e(l,1)}}function l(){for(var e=0;e<B;e+=2)(0,$[e])($[e+1]),$[e]=void 0,$[e+1]=void 0;B=0}function d(){try{var e=Function("return this")().require("vertx");return V=e.runOnLoop||e.runOnContext,s()}catch(e){return u()}}function f(e,t){var r=this,n=new this.constructor(p);void 0===n[G]&&R(n);var o=r._state;if(o){var i=arguments[o-1];J((function(){return E(o,n,i,r._result)}))}else U(r,n,e,t);return n}function h(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var r=new t(p);return b(r,e),r}function p(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function m(){return new TypeError("A promises callback cannot return that same promise.")}function g(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function w(e,t,r){J((function(e){var n=!1,o=g(r,t,(function(r){n||(n=!0,t!==r?b(e,r):A(e,r))}),(function(t){n||(n=!0,S(e,t))}),"Settle: "+(e._label||" unknown promise"));!n&&o&&(n=!0,S(e,o))}),e)}function k(e,t){t._state===Z?A(e,t._result):t._state===ee?S(e,t._result):U(t,void 0,(function(t){return b(e,t)}),(function(t){return S(e,t)}))}function y(e,r,n){r.constructor===e.constructor&&n===f&&r.constructor.resolve===h?k(e,r):void 0===n?A(e,r):t(n)?w(e,r,n):A(e,r)}function b(t,r){if(t===r)S(t,v());else if(e(r)){var n=void 0;try{n=r.then}catch(e){return void S(t,e)}y(t,r,n)}else A(t,r)}function _(e){e._onerror&&e._onerror(e._result),C(e)}function A(e,t){e._state===Q&&(e._result=t,e._state=Z,0!==e._subscribers.length&&J(C,e))}function S(e,t){e._state===Q&&(e._state=ee,e._result=t,J(_,e))}function U(e,t,r,n){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+Z]=r,o[i+ee]=n,0===i&&e._state&&J(C,e)}function C(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)n=t[s],o=t[s+r],n?E(r,n,o,i):o(i);e._subscribers.length=0}}function E(e,r,n,o){var i=t(n),s=void 0,a=void 0,c=!0;if(i){try{s=n(o)}catch(e){c=!1,a=e}if(r===s)return void S(r,m())}else s=o;r._state!==Q||(i&&c?b(r,s):!1===c?S(r,a):e===Z?A(r,s):e===ee&&S(r,s))}function T(e,t){try{t((function(t){b(e,t)}),(function(t){S(e,t)}))}catch(t){S(e,t)}}function I(){return te++}function R(e){e[G]=te++,e._state=void 0,e._result=void 0,e._subscribers=[]}function O(){return new Error("Array Methods must be provided an Array")}function x(e){return new re(this,e).promise}function L(e){var t=this;return new t(q(e)?function(r,n){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(r,n)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function P(e){var t=new this(p);return S(t,e),t}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function j(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function N(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=ne}var H=void 0;H=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var q=H,B=0,V=void 0,K=void 0,J=function(e,t){$[B]=e,$[B+1]=t,2===(B+=2)&&(K?K(l):X())},z="undefined"!=typeof window?window:void 0,D=z||{},F=D.MutationObserver||D.WebKitMutationObserver,Y="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),W="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,$=new Array(1e3),X=void 0;X=Y?i():F?a():W?c():void 0===z?d():u();var G=Math.random().toString(36).substring(2),Q=void 0,Z=1,ee=2,te=0,re=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(p),this.promise[G]||R(this.promise),q(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&A(this.promise,this._result))):S(this.promise,O())}return e.prototype._enumerate=function(e){for(var t=0;this._state===Q&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===h){var o=void 0,i=void 0,s=!1;try{o=e.then}catch(e){s=!0,i=e}if(o===f&&e._state!==Q)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(r===ne){var a=new r(p);s?S(a,i):y(a,e,o),this._willSettleAt(a,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===Q&&(this._remaining--,e===ee?S(n,r):this._result[t]=r),0===this._remaining&&A(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;U(e,void 0,(function(e){return r._settledAt(Z,t,e)}),(function(e){return r._settledAt(ee,t,e)}))},e}(),ne=function(){function e(t){this[G]=I(),this._result=this._state=void 0,this._subscribers=[],p!==t&&("function"!=typeof t&&M(),this instanceof e?T(this,t):j())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var r=this,n=r.constructor;return t(e)?r.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):r.then(e,e)},e}();return ne.prototype.then=f,ne.all=x,ne.race=L,ne.resolve=h,ne.reject=P,ne._setScheduler=n,ne._setAsap=o,ne._asap=J,ne.polyfill=N,ne.Promise=ne,ne}()}(o);for(var i=o.exports,s={byteLength:function(e){var t=f(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=f(e),o=n[0],i=n[1],s=new u(function(e,t,r){return 3*(t+r)/4-r}(0,o,i)),a=0,l=i>0?o-4:o;for(r=0;r<l;r+=4)t=c[e.charCodeAt(r)]<<18|c[e.charCodeAt(r+1)]<<12|c[e.charCodeAt(r+2)]<<6|c[e.charCodeAt(r+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;2===i&&(t=c[e.charCodeAt(r)]<<2|c[e.charCodeAt(r+1)]>>4,s[a++]=255&t);1===i&&(t=c[e.charCodeAt(r)]<<10|c[e.charCodeAt(r+1)]<<4|c[e.charCodeAt(r+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t);return s},fromByteArray:function(e){for(var t,r=e.length,n=r%3,o=[],i=16383,s=0,c=r-n;s<c;s+=i)o.push(h(e,s,s+i>c?c:s+i));1===n?(t=e[r-1],o.push(a[t>>2]+a[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(a[t>>10]+a[t>>4&63]+a[t<<2&63]+"="));return o.join("")}},a=[],c=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0;d<64;++d)a[d]=l[d],c[l.charCodeAt(d)]=d;function f(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function h(e,t,r){for(var n,o,i=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(a[(o=n)>>18&63]+a[o>>12&63]+a[o>>6&63]+a[63&o]);return i.join("")}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63;var p={exports:{}};
/**
	 * [js-sha256]{@link https://github.com/emn178/js-sha256}
	 *
	 * @version 0.10.1
	 * @author Chen, Yi-Cyuan [emn178@gmail.com]
	 * @copyright Chen, Yi-Cyuan 2014-2023
	 * @license MIT
	 */!function(n){!function(){var o="input is invalid type",i="object"==typeof window,s=i?window:{};s.JS_SHA256_NO_WINDOW&&(i=!1);var a=!i&&"object"==typeof self,c=!s.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;c?s=r:a&&(s=self);var u=!s.JS_SHA256_NO_COMMON_JS&&n.exports,l=!s.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,d="0123456789abcdef".split(""),f=[-2147483648,8388608,32768,128],h=[24,16,8,0],p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],v=["hex","array","digest","arrayBuffer"],m=[];!s.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!l||!s.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var g=function(e,t){return function(r){return new _(t,!0).update(r)[e]()}},w=function(e){var t=g("hex",e);c&&(t=k(t,e)),t.create=function(){return new _(e)},t.update=function(e){return t.create().update(e)};for(var r=0;r<v.length;++r){var n=v[r];t[n]=g(n,e)}return t},k=function(r,n){var i,a=e,c=t.Buffer,u=n?"sha224":"sha256";i=c.from&&!s.JS_SHA256_NO_BUFFER_FROM?c.from:function(e){return new c(e)};return function(e){if("string"==typeof e)return a.createHash(u).update(e,"utf8").digest("hex");if(null==e)throw new Error(o);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===c?a.createHash(u).update(i(e)).digest("hex"):r(e)}},y=function(e,t){return function(r,n){return new A(r,t,!0).update(n)[e]()}},b=function(e){var t=y("hex",e);t.create=function(t){return new A(t,e)},t.update=function(e,r){return t.create(e).update(r)};for(var r=0;r<v.length;++r){var n=v[r];t[n]=y(n,e)}return t};function _(e,t){t?(m[0]=m[16]=m[1]=m[2]=m[3]=m[4]=m[5]=m[6]=m[7]=m[8]=m[9]=m[10]=m[11]=m[12]=m[13]=m[14]=m[15]=0,this.blocks=m):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function A(e,t,r){var n,i=typeof e;if("string"===i){var s,a=[],c=e.length,u=0;for(n=0;n<c;++n)(s=e.charCodeAt(n))<128?a[u++]=s:s<2048?(a[u++]=192|s>>6,a[u++]=128|63&s):s<55296||s>=57344?(a[u++]=224|s>>12,a[u++]=128|s>>6&63,a[u++]=128|63&s):(s=65536+((1023&s)<<10|1023&e.charCodeAt(++n)),a[u++]=240|s>>18,a[u++]=128|s>>12&63,a[u++]=128|s>>6&63,a[u++]=128|63&s);e=a}else{if("object"!==i)throw new Error(o);if(null===e)throw new Error(o);if(l&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||l&&ArrayBuffer.isView(e)))throw new Error(o)}e.length>64&&(e=new _(t,!0).update(e).array());var d=[],f=[];for(n=0;n<64;++n){var h=e[n]||0;d[n]=92^h,f[n]=54^h}_.call(this,t,r),this.update(f),this.oKeyPad=d,this.inner=!0,this.sharedMemory=r}_.prototype.update=function(e){if(!this.finalized){var t,r=typeof e;if("string"!==r){if("object"!==r)throw new Error(o);if(null===e)throw new Error(o);if(l&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||l&&ArrayBuffer.isView(e)))throw new Error(o);t=!0}for(var n,i,s=0,a=e.length,c=this.blocks;s<a;){if(this.hashed&&(this.hashed=!1,c[0]=this.block,c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0),t)for(i=this.start;s<a&&i<64;++s)c[i>>2]|=e[s]<<h[3&i++];else for(i=this.start;s<a&&i<64;++s)(n=e.charCodeAt(s))<128?c[i>>2]|=n<<h[3&i++]:n<2048?(c[i>>2]|=(192|n>>6)<<h[3&i++],c[i>>2]|=(128|63&n)<<h[3&i++]):n<55296||n>=57344?(c[i>>2]|=(224|n>>12)<<h[3&i++],c[i>>2]|=(128|n>>6&63)<<h[3&i++],c[i>>2]|=(128|63&n)<<h[3&i++]):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++s)),c[i>>2]|=(240|n>>18)<<h[3&i++],c[i>>2]|=(128|n>>12&63)<<h[3&i++],c[i>>2]|=(128|n>>6&63)<<h[3&i++],c[i>>2]|=(128|63&n)<<h[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=c[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this}},_.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=f[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},_.prototype.hash=function(){var e,t,r,n,o,i,s,a,c,u=this.h0,l=this.h1,d=this.h2,f=this.h3,h=this.h4,v=this.h5,m=this.h6,g=this.h7,w=this.blocks;for(e=16;e<64;++e)t=((o=w[e-15])>>>7|o<<25)^(o>>>18|o<<14)^o>>>3,r=((o=w[e-2])>>>17|o<<15)^(o>>>19|o<<13)^o>>>10,w[e]=w[e-16]+t+w[e-7]+r|0;for(c=l&d,e=0;e<64;e+=4)this.first?(this.is224?(i=300032,g=(o=w[0]-1413257819)-150054599|0,f=o+24177077|0):(i=704751109,g=(o=w[0]-210244248)-1521486534|0,f=o+143694565|0),this.first=!1):(t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),n=(i=u&l)^u&d^c,g=f+(o=g+(r=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&v^~h&m)+p[e]+w[e])|0,f=o+(t+n)|0),t=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),n=(s=f&u)^f&l^i,m=d+(o=m+(r=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&h^~g&v)+p[e+1]+w[e+1])|0,t=((d=o+(t+n)|0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),n=(a=d&f)^d&u^s,v=l+(o=v+(r=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&g^~m&h)+p[e+2]+w[e+2])|0,t=((l=o+(t+n)|0)>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),n=(c=l&d)^l&f^a,h=u+(o=h+(r=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7))+(v&m^~v&g)+p[e+3]+w[e+3])|0,u=o+(t+n)|0,this.chromeBugWorkAround=!0;this.h0=this.h0+u|0,this.h1=this.h1+l|0,this.h2=this.h2+d|0,this.h3=this.h3+f|0,this.h4=this.h4+h|0,this.h5=this.h5+v|0,this.h6=this.h6+m|0,this.h7=this.h7+g|0},_.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,o=this.h4,i=this.h5,s=this.h6,a=this.h7,c=d[e>>28&15]+d[e>>24&15]+d[e>>20&15]+d[e>>16&15]+d[e>>12&15]+d[e>>8&15]+d[e>>4&15]+d[15&e]+d[t>>28&15]+d[t>>24&15]+d[t>>20&15]+d[t>>16&15]+d[t>>12&15]+d[t>>8&15]+d[t>>4&15]+d[15&t]+d[r>>28&15]+d[r>>24&15]+d[r>>20&15]+d[r>>16&15]+d[r>>12&15]+d[r>>8&15]+d[r>>4&15]+d[15&r]+d[n>>28&15]+d[n>>24&15]+d[n>>20&15]+d[n>>16&15]+d[n>>12&15]+d[n>>8&15]+d[n>>4&15]+d[15&n]+d[o>>28&15]+d[o>>24&15]+d[o>>20&15]+d[o>>16&15]+d[o>>12&15]+d[o>>8&15]+d[o>>4&15]+d[15&o]+d[i>>28&15]+d[i>>24&15]+d[i>>20&15]+d[i>>16&15]+d[i>>12&15]+d[i>>8&15]+d[i>>4&15]+d[15&i]+d[s>>28&15]+d[s>>24&15]+d[s>>20&15]+d[s>>16&15]+d[s>>12&15]+d[s>>8&15]+d[s>>4&15]+d[15&s];return this.is224||(c+=d[a>>28&15]+d[a>>24&15]+d[a>>20&15]+d[a>>16&15]+d[a>>12&15]+d[a>>8&15]+d[a>>4&15]+d[15&a]),c},_.prototype.toString=_.prototype.hex,_.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,o=this.h4,i=this.h5,s=this.h6,a=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,n>>24&255,n>>16&255,n>>8&255,255&n,o>>24&255,o>>16&255,o>>8&255,255&o,i>>24&255,i>>16&255,i>>8&255,255&i,s>>24&255,s>>16&255,s>>8&255,255&s];return this.is224||c.push(a>>24&255,a>>16&255,a>>8&255,255&a),c},_.prototype.array=_.prototype.digest,_.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},A.prototype=new _,A.prototype.finalize=function(){if(_.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();_.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),_.prototype.finalize.call(this)}};var S=w();S.sha256=S,S.sha224=w(!0),S.sha256.hmac=b(),S.sha224.hmac=b(!0),u?n.exports=S:(s.sha256=S.sha256,s.sha224=S.sha224)}()}(p);var v=n(p.exports);class m extends Error{}function g(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return atob(t)}}function w(e,t){if("string"!=typeof e)throw new m("Invalid token specified: must be a string");t||(t={});const r=!0===t.header?0:1,n=e.split(".")[r];if("string"!=typeof n)throw new m(`Invalid token specified: missing part #${r+1}`);let o;try{o=g(n)}catch(e){throw new m(`Invalid token specified: invalid base64 for part #${r+1} (${e.message})`)}try{return JSON.parse(o)}catch(e){throw new m(`Invalid token specified: invalid json for part #${r+1} (${e.message})`)}}if(m.prototype.name="InvalidTokenError",void 0===i.Promise)throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");return function e(t){if(!(this instanceof e))throw new Error("The 'Keycloak' constructor must be invoked with 'new'.");for(var r,n,o,a,c=this,u=[],l={enable:!0,callbackList:[],interval:5},d=document.getElementsByTagName("script"),f=0;f<d.length;f++)-1===d[f].src.indexOf("keycloak.js")&&-1===d[f].src.indexOf("keycloak.min.js")||-1===d[f].src.indexOf("version=")||(c.iframeVersion=d[f].src.substring(d[f].src.indexOf("version=")+8).split("&")[0]);var h=!0,p=P(console.info),m=P(console.warn);function g(e,t){for(var r=function(e){var t=null,r=window.crypto||window.msCrypto;if(r&&r.getRandomValues&&window.Uint8Array)return t=new Uint8Array(e),r.getRandomValues(t),t;t=new Array(e);for(var n=0;n<t.length;n++)t[n]=Math.floor(256*Math.random());return t}(e),n=new Array(e),o=0;o<e;o++)n[o]=t.charCodeAt(r[o]%t.length);return String.fromCharCode.apply(null,n)}function k(){return void 0!==c.authServerUrl?"/"==c.authServerUrl.charAt(c.authServerUrl.length-1)?c.authServerUrl+"realms/"+encodeURIComponent(c.realm):c.authServerUrl+"/realms/"+encodeURIComponent(c.realm):void 0}function y(e,t){var r=e.code,n=e.error,o=e.prompt,i=(new Date).getTime();if(e.kc_action_status&&c.onActionUpdate&&c.onActionUpdate(e.kc_action_status),n)if("none"!=o){var s={error:n,error_description:e.error_description};c.onAuthError&&c.onAuthError(s),t&&t.setError(s)}else t&&t.setSuccess();else if("standard"!=c.flow&&(e.access_token||e.id_token)&&d(e.access_token,null,e.id_token,!0),"implicit"!=c.flow&&r){var a="code="+r+"&grant_type=authorization_code",u=c.endpoints.token(),l=new XMLHttpRequest;l.open("POST",u,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.appendRequestHeader(u,l),a+="&client_id="+encodeURIComponent(c.clientId),a+="&redirect_uri="+e.redirectUri,e.pkceCodeVerifier&&(a+="&code_verifier="+e.pkceCodeVerifier),l.withCredentials=!0,l.onreadystatechange=function(){if(4==l.readyState)if(200==l.status){var e=JSON.parse(l.responseText);d(e.access_token,e.refresh_token,e.id_token,"standard"===c.flow),T()}else c.onAuthError&&c.onAuthError(),t&&t.setError()},l.send(a)}function d(r,n,o,s){_(r,n,o,i=(i+(new Date).getTime())/2),h&&(c.tokenParsed&&c.tokenParsed.nonce!=e.storedNonce||c.refreshTokenParsed&&c.refreshTokenParsed.nonce!=e.storedNonce||c.idTokenParsed&&c.idTokenParsed.nonce!=e.storedNonce)?(p("[KEYCLOAK] Invalid nonce, clearing token"),c.clearToken(),t&&t.setError()):s&&(c.onAuthSuccess&&c.onAuthSuccess(),t&&t.setSuccess())}}function b(e){return 0==e.status&&e.responseText&&e.responseURL.startsWith("file:")}function _(e,t,r,n){if(c.tokenTimeoutHandle&&(clearTimeout(c.tokenTimeoutHandle),c.tokenTimeoutHandle=null),t?(c.refreshToken=t,c.refreshTokenParsed=w(t)):(delete c.refreshToken,delete c.refreshTokenParsed),r?(c.idToken=r,c.idTokenParsed=w(r)):(delete c.idToken,delete c.idTokenParsed),e){if(c.token=e,c.tokenParsed=w(e),c.sessionId=c.tokenParsed.session_state,c.authenticated=!0,c.subject=c.tokenParsed.sub,c.realmAccess=c.tokenParsed.realm_access,c.resourceAccess=c.tokenParsed.resource_access,n&&(c.timeSkew=Math.floor(n/1e3)-c.tokenParsed.iat),null!=c.timeSkew&&(p("[KEYCLOAK] Estimated time difference between browser and server is "+c.timeSkew+" seconds"),c.onTokenExpired)){var o=1e3*(c.tokenParsed.exp-(new Date).getTime()/1e3+c.timeSkew);p("[KEYCLOAK] Token expires in "+Math.round(o/1e3)+" s"),o<=0?c.onTokenExpired():c.tokenTimeoutHandle=setTimeout(c.onTokenExpired,o)}}else delete c.token,delete c.tokenParsed,delete c.subject,delete c.realmAccess,delete c.resourceAccess,c.authenticated=!1}function A(){var e="0123456789abcdef",t=g(36,e).split("");return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}function S(e){var t=function(e){var t;switch(c.flow){case"standard":t=["code","state","session_state","kc_action_status","iss"];break;case"implicit":t=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status","iss"];break;case"hybrid":t=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status","iss"]}t.push("error"),t.push("error_description"),t.push("error_uri");var r,n,o=e.indexOf("?"),i=e.indexOf("#");"query"===c.responseMode&&-1!==o?(r=e.substring(0,o),""!==(n=U(e.substring(o+1,-1!==i?i:e.length),t)).paramsString&&(r+="?"+n.paramsString),-1!==i&&(r+=e.substring(i))):"fragment"===c.responseMode&&-1!==i&&(r=e.substring(0,i),""!==(n=U(e.substring(i+1),t)).paramsString&&(r+="#"+n.paramsString));if(n&&n.oauthParams)if("standard"===c.flow||"hybrid"===c.flow){if((n.oauthParams.code||n.oauthParams.error)&&n.oauthParams.state)return n.oauthParams.newUrl=r,n.oauthParams}else if("implicit"===c.flow&&(n.oauthParams.access_token||n.oauthParams.error)&&n.oauthParams.state)return n.oauthParams.newUrl=r,n.oauthParams}(e);if(t){var r=n.get(t.state);return r&&(t.valid=!0,t.redirectUri=r.redirectUri,t.storedNonce=r.nonce,t.prompt=r.prompt,t.pkceCodeVerifier=r.pkceCodeVerifier),t}}function U(e,t){for(var r=e.split("&"),n={paramsString:"",oauthParams:{}},o=0;o<r.length;o++){var i=r[o].indexOf("="),s=r[o].slice(0,i);-1!==t.indexOf(s)?n.oauthParams[s]=r[o].slice(i+1):(""!==n.paramsString&&(n.paramsString+="&"),n.paramsString+=r[o])}return n}function C(){var e={setSuccess:function(t){e.resolve(t)},setError:function(t){e.reject(t)}};return e.promise=new i.Promise((function(t,r){e.resolve=t,e.reject=r})),e}function E(){var e=C();if(!l.enable)return e.setSuccess(),e.promise;if(l.iframe)return e.setSuccess(),e.promise;var t=document.createElement("iframe");l.iframe=t,t.onload=function(){var t=c.endpoints.authorize();"/"===t.charAt(0)?l.iframeOrigin=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""):l.iframeOrigin=t.substring(0,t.indexOf("/",8)),e.setSuccess()};var r=c.endpoints.checkSessionIframe();t.setAttribute("src",r),t.setAttribute("sandbox","allow-scripts allow-same-origin"),t.setAttribute("title","keycloak-session-iframe"),t.style.display="none",document.body.appendChild(t);return window.addEventListener("message",(function(e){if(e.origin===l.iframeOrigin&&l.iframe.contentWindow===e.source&&("unchanged"==e.data||"changed"==e.data||"error"==e.data)){"unchanged"!=e.data&&c.clearToken();for(var t=l.callbackList.splice(0,l.callbackList.length),r=t.length-1;r>=0;--r){var n=t[r];"error"==e.data?n.setError():n.setSuccess("unchanged"==e.data)}}}),!1),e.promise}function T(){l.enable&&c.token&&setTimeout((function(){I().then((function(e){e&&T()}))}),1e3*l.interval)}function I(){var e=C();if(l.iframe&&l.iframeOrigin){var t=c.clientId+" "+(c.sessionId?c.sessionId:"");l.callbackList.push(e);var r=l.iframeOrigin;1==l.callbackList.length&&l.iframe.contentWindow.postMessage(t,r)}else e.setSuccess();return e.promise}function R(){var e=C();if(l.enable||c.silentCheckSsoRedirectUri){var t=document.createElement("iframe");t.setAttribute("src",c.endpoints.thirdPartyCookiesIframe()),t.setAttribute("sandbox","allow-scripts allow-same-origin"),t.setAttribute("title","keycloak-3p-check-iframe"),t.style.display="none",document.body.appendChild(t);var r=function(n){t.contentWindow===n.source&&("supported"!==n.data&&"unsupported"!==n.data||("unsupported"===n.data&&(m("[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:\n\n - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).\n - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).\n\nFor more information see: https://www.keycloak.org/docs/latest/securing_apps/#_modern_browsers"),l.enable=!1,c.silentCheckSsoFallback&&(c.silentCheckSsoRedirectUri=!1)),document.body.removeChild(t),window.removeEventListener("message",r),e.setSuccess()))};window.addEventListener("message",r,!1)}else e.setSuccess();return function(e,t,r){var n=null,o=new i.Promise((function(e,o){n=setTimeout((function(){o({error:r})}),t)}));return i.Promise.race([e,o]).finally((function(){clearTimeout(n)}))}(e.promise,c.messageReceiveTimeout,"Timeout when waiting for 3rd party check iframe message.")}function O(e){if(!e||"default"==e)return{login:function(e){return window.location.assign(c.createLoginUrl(e)),C().promise},logout:function(e){return window.location.replace(c.createLogoutUrl(e)),C().promise},register:function(e){return window.location.assign(c.createRegisterUrl(e)),C().promise},accountManagement:function(){var e=c.createAccountUrl();if(void 0===e)throw"Not supported by the OIDC server";return window.location.href=e,C().promise},redirectUri:function(e,t){return e&&e.redirectUri?e.redirectUri:c.redirectUri?c.redirectUri:location.href}};if("cordova"==e){l.enable=!1;var t=function(e,t,r){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(e,t,r):window.open(e,t,r)},r=function(e){var t=function(e){return e&&e.cordovaOptions?Object.keys(e.cordovaOptions).reduce((function(t,r){return t[r]=e.cordovaOptions[r],t}),{}):{}}(e);return t.location="no",e&&"none"==e.prompt&&(t.hidden="yes"),function(e){return Object.keys(e).reduce((function(t,r){return t.push(r+"="+e[r]),t}),[]).join(",")}(t)},n=c.redirectUri||"http://localhost";return{login:function(e){var o=C(),i=r(e),s=c.createLoginUrl(e),a=t(s,"_blank",i),u=!1,l=!1,d=function(){l=!0,a.close()};return a.addEventListener("loadstart",(function(e){0==e.url.indexOf(n)&&(y(S(e.url),o),d(),u=!0)})),a.addEventListener("loaderror",(function(e){u||(0==e.url.indexOf(n)?(y(S(e.url),o),d(),u=!0):(o.setError(),d()))})),a.addEventListener("exit",(function(e){l||o.setError({reason:"closed_by_user"})})),o.promise},logout:function(e){var r,o=C(),i=c.createLogoutUrl(e),s=t(i,"_blank","location=no,hidden=yes,clearcache=yes");return s.addEventListener("loadstart",(function(e){0==e.url.indexOf(n)&&s.close()})),s.addEventListener("loaderror",(function(e){0==e.url.indexOf(n)||(r=!0),s.close()})),s.addEventListener("exit",(function(e){r?o.setError():(c.clearToken(),o.setSuccess())})),o.promise},register:function(e){var o=C(),i=c.createRegisterUrl(),s=r(e),a=t(i,"_blank",s);return a.addEventListener("loadstart",(function(e){0==e.url.indexOf(n)&&(a.close(),y(S(e.url),o))})),o.promise},accountManagement:function(){var e=c.createAccountUrl();if(void 0===e)throw"Not supported by the OIDC server";var r=t(e,"_blank","location=no");r.addEventListener("loadstart",(function(e){0==e.url.indexOf(n)&&r.close()}))},redirectUri:function(e){return n}}}if("cordova-native"==e)return l.enable=!1,{login:function(e){var t=C(),r=c.createLoginUrl(e);return universalLinks.subscribe("keycloak",(function(e){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),y(S(e.url),t)})),window.cordova.plugins.browsertab.openUrl(r),t.promise},logout:function(e){var t=C(),r=c.createLogoutUrl(e);return universalLinks.subscribe("keycloak",(function(e){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),c.clearToken(),t.setSuccess()})),window.cordova.plugins.browsertab.openUrl(r),t.promise},register:function(e){var t=C(),r=c.createRegisterUrl(e);return universalLinks.subscribe("keycloak",(function(e){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),y(S(e.url),t)})),window.cordova.plugins.browsertab.openUrl(r),t.promise},accountManagement:function(){var e=c.createAccountUrl();if(void 0===e)throw"Not supported by the OIDC server";window.cordova.plugins.browsertab.openUrl(e)},redirectUri:function(e){return e&&e.redirectUri?e.redirectUri:c.redirectUri?c.redirectUri:"http://localhost"}};throw"invalid adapter type: "+e}c.init=function(e){if(c.didInitialize)throw new Error("A 'Keycloak' instance can only be initialized once.");c.didInitialize=!0,c.authenticated=!1,n=function(){try{return new x}catch(e){}return new L}();if(r=e&&["default","cordova","cordova-native"].indexOf(e.adapter)>-1?O(e.adapter):e&&"object"==typeof e.adapter?e.adapter:window.Cordova||window.cordova?O("cordova"):O(),e){if(o=e.requestHeader,a=e.logger,void 0!==e.useNonce&&(h=e.useNonce),void 0!==e.checkLoginIframe&&(l.enable=e.checkLoginIframe),e.checkLoginIframeInterval&&(l.interval=e.checkLoginIframeInterval),"login-required"===e.onLoad&&(c.loginRequired=!0),e.responseMode){if("query"!==e.responseMode&&"fragment"!==e.responseMode)throw"Invalid value for responseMode";c.responseMode=e.responseMode}if(e.flow){switch(e.flow){case"standard":c.responseType="code";break;case"implicit":c.responseType="id_token token";break;case"hybrid":c.responseType="code id_token token";break;default:throw"Invalid value for flow"}c.flow=e.flow}if(null!=e.timeSkew&&(c.timeSkew=e.timeSkew),e.redirectUri&&(c.redirectUri=e.redirectUri),e.silentCheckSsoRedirectUri&&(c.silentCheckSsoRedirectUri=e.silentCheckSsoRedirectUri),"boolean"==typeof e.silentCheckSsoFallback?c.silentCheckSsoFallback=e.silentCheckSsoFallback:c.silentCheckSsoFallback=!0,e.pkceMethod){if("S256"!==e.pkceMethod)throw"Invalid value for pkceMethod";c.pkceMethod=e.pkceMethod}"boolean"==typeof e.enableLogging?c.enableLogging=e.enableLogging:c.enableLogging=!1,"string"==typeof e.scope&&(c.scope=e.scope),"string"==typeof e.acrValues&&(c.acrValues=e.acrValues),"number"==typeof e.messageReceiveTimeout&&e.messageReceiveTimeout>0?c.messageReceiveTimeout=e.messageReceiveTimeout:c.messageReceiveTimeout=1e4}c.responseMode||(c.responseMode="fragment"),c.responseType||(c.responseType="code",c.flow="standard");var i=C(),s=C();s.promise.then((function(){c.onReady&&c.onReady(c.authenticated),i.setSuccess(c.authenticated)})).catch((function(e){i.setError(e)}));var u=function(){var e,r=C();t?"string"==typeof t&&(e=t):e="keycloak.json";function n(e){c.endpoints=e?{authorize:function(){return e.authorization_endpoint},token:function(){return e.token_endpoint},logout:function(){if(!e.end_session_endpoint)throw"Not supported by the OIDC server";return e.end_session_endpoint},checkSessionIframe:function(){if(!e.check_session_iframe)throw"Not supported by the OIDC server";return e.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!e.userinfo_endpoint)throw"Not supported by the OIDC server";return e.userinfo_endpoint}}:{authorize:function(){return k()+"/protocol/openid-connect/auth"},token:function(){return k()+"/protocol/openid-connect/token"},logout:function(){return k()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var e=k()+"/protocol/openid-connect/login-status-iframe.html";return c.iframeVersion&&(e=e+"?version="+c.iframeVersion),e},thirdPartyCookiesIframe:function(){var e=k()+"/protocol/openid-connect/3p-cookies/step1.html";return c.iframeVersion&&(e=e+"?version="+c.iframeVersion),e},register:function(){return k()+"/protocol/openid-connect/registrations"},userinfo:function(){return k()+"/protocol/openid-connect/userinfo"}}}if(e){(s=new XMLHttpRequest).open("GET",e,!0),s.setRequestHeader("Accept","application/json"),c.appendRequestHeader(e,s),s.onreadystatechange=function(){if(4==s.readyState)if(200==s.status||b(s)){var e=JSON.parse(s.responseText);c.authServerUrl=e["auth-server-url"],c.realm=e.realm,c.clientId=e.resource,n(null),r.setSuccess()}else r.setError()},s.send()}else{if(!t.clientId)throw"clientId missing";c.clientId=t.clientId;var o=t.oidcProvider;if(o){var i,s;if("string"==typeof o)i="/"==o.charAt(o.length-1)?o+".well-known/openid-configuration":o+"/.well-known/openid-configuration",(s=new XMLHttpRequest).open("GET",i,!0),s.setRequestHeader("Accept","application/json"),c.appendRequestHeader(e,s),s.onreadystatechange=function(){4==s.readyState&&(200==s.status||b(s)?(n(JSON.parse(s.responseText)),r.setSuccess()):r.setError())},s.send();else n(o),r.setSuccess()}else{if(!t.url)for(var a=document.getElementsByTagName("script"),u=0;u<a.length;u++)if(a[u].src.match(/.*keycloak\.js/)){t.url=a[u].src.substr(0,a[u].src.indexOf("/js/keycloak.js"));break}if(!t.realm)throw"realm missing";c.authServerUrl=t.url,c.realm=t.realm,n(null),r.setSuccess()}}return r.promise}();function d(){var t=function(t){t||(n.prompt="none"),e&&e.locale&&(n.locale=e.locale),c.login(n).then((function(){s.setSuccess()})).catch((function(e){s.setError(e)}))},r=function(){var e=document.createElement("iframe"),t=c.createLoginUrl({prompt:"none",redirectUri:c.silentCheckSsoRedirectUri});e.setAttribute("src",t),e.setAttribute("sandbox","allow-scripts allow-same-origin"),e.setAttribute("title","keycloak-silent-check-sso"),e.style.display="none",document.body.appendChild(e);var r=function(t){t.origin===window.location.origin&&e.contentWindow===t.source&&(y(S(t.data),s),document.body.removeChild(e),window.removeEventListener("message",r))};window.addEventListener("message",r)},n={};switch(e.onLoad){case"check-sso":l.enable?E().then((function(){I().then((function(e){e?s.setSuccess():c.silentCheckSsoRedirectUri?r():t(!1)})).catch((function(e){s.setError(e)}))})):c.silentCheckSsoRedirectUri?r():t(!1);break;case"login-required":t(!0);break;default:throw"Invalid value for onLoad"}}function f(){var t=S(window.location.href);if(t&&window.history.replaceState(window.history.state,null,t.newUrl),t&&t.valid)return E().then((function(){y(t,s)})).catch((function(e){s.setError(e)}));e?e.token&&e.refreshToken?(_(e.token,e.refreshToken,e.idToken),l.enable?E().then((function(){I().then((function(e){e?(c.onAuthSuccess&&c.onAuthSuccess(),s.setSuccess(),T()):s.setSuccess()})).catch((function(e){s.setError(e)}))})):c.updateToken(-1).then((function(){c.onAuthSuccess&&c.onAuthSuccess(),s.setSuccess()})).catch((function(t){c.onAuthError&&c.onAuthError(),e.onLoad?d():s.setError(t)}))):e.onLoad?d():s.setSuccess():s.setSuccess()}return u.then((function(){(function(){var e=C(),t=function(){"interactive"!==document.readyState&&"complete"!==document.readyState||(document.removeEventListener("readystatechange",t),e.setSuccess())};return document.addEventListener("readystatechange",t),t(),e.promise})().then(R).then(f).catch((function(e){i.setError(e)}))})),u.catch((function(e){i.setError(e)})),i.promise},c.login=function(e){return r.login(e)},c.createLoginUrl=function(e){var t,o=A(),i=A(),a=r.redirectUri(e),u={state:o,nonce:i,redirectUri:encodeURIComponent(a)};e&&e.prompt&&(u.prompt=e.prompt),t=e&&"register"==e.action?c.endpoints.register():c.endpoints.authorize();var l=e&&e.scope||c.scope;l?-1===l.indexOf("openid")&&(l="openid "+l):l="openid";var d,f,p=t+"?client_id="+encodeURIComponent(c.clientId)+"&redirect_uri="+encodeURIComponent(a)+"&state="+encodeURIComponent(o)+"&response_mode="+encodeURIComponent(c.responseMode)+"&response_type="+encodeURIComponent(c.responseType)+"&scope="+encodeURIComponent(l);if(h&&(p=p+"&nonce="+encodeURIComponent(i)),e&&e.prompt&&(p+="&prompt="+encodeURIComponent(e.prompt)),e&&e.maxAge&&(p+="&max_age="+encodeURIComponent(e.maxAge)),e&&e.loginHint&&(p+="&login_hint="+encodeURIComponent(e.loginHint)),e&&e.idpHint&&(p+="&kc_idp_hint="+encodeURIComponent(e.idpHint)),e&&e.action&&"register"!=e.action&&(p+="&kc_action="+encodeURIComponent(e.action)),e&&e.locale&&(p+="&ui_locales="+encodeURIComponent(e.locale)),e&&e.acr){var m=(d=e.acr,f={id_token:{acr:d}},JSON.stringify(f));p+="&claims="+encodeURIComponent(m)}if((e&&e.acrValues||c.acrValues)&&(p+="&acr_values="+encodeURIComponent(e.acrValues||c.acrValues)),c.pkceMethod){var w=function(e){return g(e,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}(96);u.pkceCodeVerifier=w;var k=function(e,t){if("S256"===e){var r=new Uint8Array(v.arrayBuffer(t));return s.fromByteArray(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}throw"Invalid value for pkceMethod"}(c.pkceMethod,w);p+="&code_challenge="+k,p+="&code_challenge_method="+c.pkceMethod}return n.add(u),p},c.logout=function(e){return r.logout(e)},c.createLogoutUrl=function(e){var t=c.endpoints.logout()+"?client_id="+encodeURIComponent(c.clientId)+"&post_logout_redirect_uri="+encodeURIComponent(r.redirectUri(e,!1));return c.idToken&&(t+="&id_token_hint="+encodeURIComponent(c.idToken)),t},c.register=function(e){return r.register(e)},c.createRegisterUrl=function(e){return e||(e={}),e.action="register",c.createLoginUrl(e)},c.createAccountUrl=function(e){var t=k(),n=void 0;return void 0!==t&&(n=t+"/account?referrer="+encodeURIComponent(c.clientId)+"&referrer_uri="+encodeURIComponent(r.redirectUri(e))),n},c.accountManagement=function(){return r.accountManagement()},c.hasRealmRole=function(e){var t=c.realmAccess;return!!t&&t.roles.indexOf(e)>=0},c.hasResourceRole=function(e,t){if(!c.resourceAccess)return!1;var r=c.resourceAccess[t||c.clientId];return!!r&&r.roles.indexOf(e)>=0},c.appendRequestHeader=function(e,t){if(o)for(const[r,n]of Object.entries(o))a.info(`+++set Request header on keycloak to ${e} with ${r}: ${n}`),t.setRequestHeader(r,n)},c.loadUserProfile=function(){var e=k()+"/account",t=new XMLHttpRequest;t.open("GET",e,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Authorization","bearer "+c.token),c.appendRequestHeader(e,t);var r=C();return t.onreadystatechange=function(){4==t.readyState&&(200==t.status?(c.profile=JSON.parse(t.responseText),r.setSuccess(c.profile)):r.setError())},t.send(),r.promise},c.loadUserInfo=function(){var e=c.endpoints.userinfo(),t=new XMLHttpRequest;t.open("GET",e,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Authorization","bearer "+c.token),c.appendRequestHeader(e,t);var r=C();return t.onreadystatechange=function(){4==t.readyState&&(200==t.status?(c.userInfo=JSON.parse(t.responseText),r.setSuccess(c.userInfo)):r.setError())},t.send(),r.promise},c.isTokenExpired=function(e){if(!c.tokenParsed||!c.refreshToken&&"implicit"!=c.flow)throw"Not authenticated";if(null==c.timeSkew)return p("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var t=c.tokenParsed.exp-Math.ceil((new Date).getTime()/1e3)+c.timeSkew;if(e){if(isNaN(e))throw"Invalid minValidity";t-=e}return t<0},c.updateToken=function(e){var t=C();if(!c.refreshToken)return t.setError(),t.promise;e=e||5;var r=function(){var r=!1;if(-1==e?(r=!0,p("[KEYCLOAK] Refreshing token: forced refresh")):c.tokenParsed&&!c.isTokenExpired(e)||(r=!0,p("[KEYCLOAK] Refreshing token: token expired")),r){var n="grant_type=refresh_token&refresh_token="+c.refreshToken,o=c.endpoints.token();if(u.push(t),1==u.length){var i=new XMLHttpRequest;i.open("POST",o,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.appendRequestHeader(o,i),i.withCredentials=!0,n+="&client_id="+encodeURIComponent(c.clientId);var s=(new Date).getTime();i.onreadystatechange=function(){if(4==i.readyState)if(200==i.status){p("[KEYCLOAK] Token refreshed"),s=(s+(new Date).getTime())/2;var e=JSON.parse(i.responseText);_(e.access_token,e.refresh_token,e.id_token,s),c.onAuthRefreshSuccess&&c.onAuthRefreshSuccess();for(var t=u.pop();null!=t;t=u.pop())t.setSuccess(!0)}else{m("[KEYCLOAK] Failed to refresh token"),400==i.status&&c.clearToken(),c.onAuthRefreshError&&c.onAuthRefreshError();for(t=u.pop();null!=t;t=u.pop())t.setError(!0)}},i.send(n)}}else t.setSuccess(!1)};l.enable?I().then((function(){r()})).catch((function(e){t.setError(e)})):r();return t.promise},c.clearToken=function(){c.token&&(_(null,null,null),c.onAuthLogout&&c.onAuthLogout(),c.loginRequired&&c.login())};var x=function(){if(!(this instanceof x))return new x;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");function e(){for(var e=(new Date).getTime(),t=0;t<localStorage.length;t++){var r=localStorage.key(t);if(r&&0==r.indexOf("kc-callback-")){var n=localStorage.getItem(r);if(n)try{var o=JSON.parse(n).expires;(!o||o<e)&&localStorage.removeItem(r)}catch(e){localStorage.removeItem(r)}}}}this.get=function(t){if(t){var r="kc-callback-"+t,n=localStorage.getItem(r);return n&&(localStorage.removeItem(r),n=JSON.parse(n)),e(),n}},this.add=function(t){e();var r="kc-callback-"+t.state;t.expires=(new Date).getTime()+36e5,localStorage.setItem(r,JSON.stringify(t))}},L=function(){if(!(this instanceof L))return new L;var e=this;e.get=function(e){if(e){var o=r("kc-callback-"+e);return n("kc-callback-"+e,"",t(-100)),o?JSON.parse(o):void 0}},e.add=function(e){n("kc-callback-"+e.state,JSON.stringify(e),t(60))},e.removeItem=function(e){n(e,"",t(-100))};var t=function(e){var t=new Date;return t.setTime(t.getTime()+60*e*1e3),t},r=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""},n=function(e,t,r){var n=e+"="+t+"; expires="+r.toUTCString()+"; ";document.cookie=n}};function P(e){return function(){c.enableLogging&&e.apply(console,Array.prototype.slice.call(arguments))}}}}));
//# sourceMappingURL=keycloak.min.js.map
